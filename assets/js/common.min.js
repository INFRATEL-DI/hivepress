var hivepress={getSelector:function(t){return'[data-component="'+t+'"]'},getComponent:function(t){return jQuery(this.getSelector(t))}};!function(t){"use strict";t(document).ready(function(){hivepress.getComponent("link").on("click",function(e){var a=t(this).data("url");0!==a.indexOf("#")&&(window.location.href=a),e.preventDefault()}),hivepress.getComponent("select").each(function(){var e=t(this),a={width:"100%",dropdownAutoWidth:!1,minimumResultsForSearch:20,templateResult:function(e){var a=e.text,n=0;return e.element&&(n=parseInt(t(e.element).data("level")),a=t("<div />").css("padding-left",20*n+"px").text(a)),a}};if(e.data("placeholder")&&(a.placeholder=e.data("placeholder")),"inline"===e.data("style")&&t.extend(a,{containerCssClass:"select2-selection--inline",dropdownCssClass:"select2-dropdown--inline",width:"resolve",dropdownAutoWidth:!0,minimumResultsForSearch:-1}),"icon"===e.data("template")){var n=function(t){var e=t.text;return t.id&&(e='<i class="fas fa-fw fa-'+t.id+'"></i> '+t.text),e};t.extend(a,{templateResult:n,templateSelection:n,escapeMarkup:function(t){return t}})}if(e.data("source"))if(t.extend(a,{ajax:{url:e.data("source"),dataType:"json",delay:250,cache:!0,data:function(t){return{search:t.term,context:"list",parent_value:e.data("parent-value"),_wpnonce:hivepressCoreData.apiNonce}},processResults:function(t){var e=[];return t&&t.hasOwnProperty("data")&&(e=t.data),{results:e}}}}),e.data("parent")){var r=t(':input[name="'+e.data("parent")+'"]');r.length&&r.on("change",function(){e.data("parent-value",t(this).val())})}else a.minimumInputLength=3;e.data("input")&&t.extend(a,{tags:!0,tokenSeparators:[","]}),e.select2(a)});var e=new DateFormatter;if(flatpickr.l10ns.hasOwnProperty(hivepressCoreData.language)){var a=flatpickr.l10ns[hivepressCoreData.language];flatpickr.localize(a),e=new DateFormatter({dateSettings:{days:a.weekdays.longhand,daysShort:a.weekdays.shorthand,months:a.months.longhand,monthsShort:a.months.shorthand,meridiem:a.amPM}})}hivepress.getComponent("date").each(function(){var a=t(this),n={allowInput:!0,altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d",defaultHour:0,onOpen:function(e,a,n){t(n.altInput).prop("readonly",!0)},onClose:function(e,a,n){t(n.altInput).prop("readonly",!1),t(n.altInput).blur()}};if(a.data("format")&&(n.dateFormat=a.data("format")),a.data("display-format")&&(n.altFormat=a.data("display-format")),a.data("min-date")&&(n.minDate=a.data("min-date")),a.data("max-date")&&(n.maxDate=a.data("max-date")),a.data("disabled-dates")&&(n.disable=a.data("disabled-dates")),a.is("[data-offset]")&&(n.minDate=(new Date).fp_incr(a.data("offset"))),a.is("[data-window]")&&(n.maxDate=(new Date).fp_incr(a.data("window"))),a.data("time")&&(n.enableTime=!0),a.data("mode")&&(n.mode=a.data("mode"),"range"===a.data("mode"))){var r=a.parent().find('input[type="hidden"]').not(a),o=a.data("min-length"),d=a.data("max-length");t.extend(n,{defaultDate:[r.eq(0).val(),r.eq(1).val()],errorHandler:function(t){},onChange:function(t,a,i){if(2===t.length){if(o||d){var s=Math.floor((t[1].getTime()-t[0].getTime())/864e5),l=0;s<o?l=o-s:s>d&&(l=d-s),l&&(t[1].setDate(t[1].getDate()+l),i.setDate(t),i.open())}var p=t.map(function(t){return e.formatDate(t,n.dateFormat)});r.eq(0).val(p[0]),r.eq(1).val(p[1])}}})}t.extend(n,{time_24hr:-1===n.altFormat.indexOf("a")&&-1===n.altFormat.indexOf("A"),parseDate:function(t){return e.parseDate(t,n.dateFormat)},formatDate:function(t,a){return e.formatDate(t,a)}}),a.flatpickr(n)}),hivepress.getComponent("time").each(function(){var a=t(this),n={allowInput:!0,altInput:!0,noCalendar:!0,enableTime:!0,dateFormat:"U",altFormat:"g:i A",defaultHour:0,parseDate:function(t){var e=new Date;return e.setHours(Math.floor(t/3600)),e.setMinutes(Math.floor(t%3600/60)),e.setSeconds(t%60),e},formatDate:function(t,a){return"U"===a?3600*t.getHours()+60*t.getMinutes()+t.getSeconds():e.formatDate(t,a)},onOpen:function(e,a,n){t(n.altInput).prop("readonly",!0)},onClose:function(e,a,n){t(n.altInput).prop("readonly",!1),t(n.altInput).blur()}};a.data("display-format")&&(n.altFormat=a.data("display-format")),-1===n.altFormat.indexOf("a")&&-1===n.altFormat.indexOf("A")&&(n.time_24hr=!0),a.flatpickr(n)}),hivepress.getComponent("file-upload").each(function(){var e=t(this),a=e.parents("[data-model]:first"),n=e.closest("form").find(":submit"),r=e.closest("label"),o=r.find("button").first(),d=r.parent().find(hivepress.getSelector("messages")).first(),i=r.parent().children("div").first();e.fileupload({url:e.data("url"),dataType:"json",paramName:"file",formData:{parent_model:a.data("model"),parent_field:e.data("name"),parent:a.data("id"),render:!0,_wpnonce:hivepressCoreData.apiNonce},start:function(){e.prop("disabled",!0),o.prop("disabled",!0),o.attr("data-state","loading"),n.length&&(n.prop("disabled",!0),n.attr("data-state","loading")),d.hide().html("")},stop:function(){e.prop("disabled",!1),o.prop("disabled",!1),o.attr("data-state",""),n.length&&(n.prop("disabled",!1),n.attr("data-state",""))},always:function(a,n){var r=n.jqXHR.responseJSON;r.hasOwnProperty("data")?e.prop("multiple")?i.append(r.data.html):i.html(r.data.html):r.hasOwnProperty("error")&&(r.error.hasOwnProperty("errors")?t.each(r.error.errors,function(t,e){d.append("<div>"+e.message+"</div>")}):r.error.hasOwnProperty("message")&&d.html("<div>"+r.error.message+"</div>"),d.is(":empty")||d.show())}})}),t(document).on("click",hivepress.getSelector("file-delete"),function(e){var a=t(this).parent();t.ajax({url:t(this).data("url"),method:"DELETE",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}}),a.remove(),e.preventDefault()}),hivepress.getComponent("sortable").each(function(){var e=t(this);e.sortable({stop:function(){e.children().length>1&&e.children().each(function(e){t.ajax({url:t(this).data("url"),method:"POST",data:{sort_order:e},beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}})})}})})})}(jQuery);
