var hivepress={getSelector:function(a){return"[data-component=\""+a+"\"]"},getComponent:function(a){return jQuery(this.getSelector(a))}};(function(b){"use strict";b(document).ready(function(){var a=Math.floor;hivepress.getComponent("link").on("click",function(a){var c=b(this).data("url");0!==c.indexOf("#")&&(window.location.href=c),a.preventDefault()}),hivepress.getComponent("modal").each(function(){var a="#"+b(this).attr("id");b("a[href=\""+a+"\"], button[data-url=\""+a+"\"]").on("click",function(c){b.fancybox.close(),b.fancybox.open({src:a,touch:!1}),c.preventDefault()})}),hivepress.getComponent("select").each(function(){var a=b(this),c={width:"100%",dropdownAutoWidth:!1,minimumResultsForSearch:20,templateResult:function(a){var c=a.text,d=0;return a.element&&(d=parseInt(b(a.element).data("level")),c=b("<div />").css("padding-left",20*d+"px").text(c)),c}};if(a.data("placeholder")&&(c.placeholder=a.data("placeholder")),"inline"===a.data("style")&&b.extend(c,{containerCssClass:"select2-selection--inline",dropdownCssClass:"select2-dropdown--inline",width:"resolve",dropdownAutoWidth:!0,minimumResultsForSearch:-1}),"icon"===a.data("template")){var d=function(a){var b=a.text;return a.id&&(b="<i class=\"fas fa-fw fa-"+a.id+"\"></i> "+a.text),b};b.extend(c,{templateResult:d,templateSelection:d,escapeMarkup:function(a){return a}})}if(a.data("source"))if(b.extend(c,{ajax:{url:a.data("source"),dataType:"json",delay:250,cache:!0,data:function(b){return{search:b.term,context:"list",parent_value:a.data("parent-value"),_wpnonce:hivepressCoreData.apiNonce}},processResults:function(a){var b=[];return a&&a.hasOwnProperty("data")&&(b=a.data),{results:b}}}}),a.data("parent")){var e=a.closest("form").find(":input[name=\""+a.data("parent")+"\"]");e.length&&e.on("change",function(){a.data("parent-value",b(this).val())})}else c.minimumInputLength=3;a.data("input")&&b.extend(c,{tags:!0,tokenSeparators:[","]}),a.select2(c)});var c=new DateFormatter;if(flatpickr.l10ns.hasOwnProperty(hivepressCoreData.language)){var d=flatpickr.l10ns[hivepressCoreData.language];flatpickr.localize(d),c=new DateFormatter({dateSettings:{days:d.weekdays.longhand,daysShort:d.weekdays.shorthand,months:d.months.longhand,monthsShort:d.months.shorthand,meridiem:d.hasOwnProperty("amPM")?d.amPM:["AM","PM"]}})}hivepress.getComponent("date").each(function(){var d=b(this),e={allowInput:!0,altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d",defaultHour:0,disable:[],disableMobile:!0,onOpen:function(a,c,d){b(d.altInput).prop("readonly",!0),b(d.element).find("[data-clear]").show()},onClose:function(a,c,d){b(d.altInput).prop("readonly",!1),b(d.altInput).blur(),b(d.element).find("[data-clear]").hide(),b(d.element).data("reset")&&(d.clear(),b(d.element).data("reset",!1))}};if(d.is("div")&&(e.wrap=!0,e.altInputClass="",d.find("[data-clear]").on("click",function(){d.data("reset",!0)})),d.data("format")&&(e.dateFormat=d.data("format")),d.data("display-format")&&(e.altFormat=d.data("display-format")),d.data("min-date")&&(e.minDate=d.data("min-date")),d.data("max-date")&&(e.maxDate=d.data("max-date")),d.data("disabled-dates")&&(e.disable=d.data("disabled-dates")),d.data("disabled-days")){var f=d.data("disabled-days");if(f.length){e.disable.push(function(a){return-1!==f.indexOf(a.getDay())})}}if(d.data("ranges")){var g=d.data("ranges");e.onDayCreate=function(c,d,e,f){if(!f.className.includes("disabled")){var h=a(f.dateObj.getTime()/1e3)-60*f.dateObj.getTimezoneOffset();b.each(g,function(a,b){if(b.start<=h&&h<b.end)return f.innerHTML+="<span class=\"flatpickr-day-label\">"+b.label+"</span>",f.className+=" flatpickr-status",b.hasOwnProperty("status")&&(f.className+=" flatpickr-status--"+b.status),!1})}}}if(d.is("[data-offset]")&&(e.minDate=new Date().fp_incr(d.data("offset"))),d.is("[data-window]")&&(e.maxDate=new Date().fp_incr(d.data("window"))),d.data("time")&&(e.enableTime=!0),d.data("mode")&&(e.mode=d.data("mode"),"range"===d.data("mode"))){var h=d.parent().find("input[type=\"hidden\"]").not(d),i=d.data("min-length"),j=d.data("max-length");b.extend(e,{defaultDate:[h.eq(0).val(),h.eq(1).val()],errorHandler:function(){},onChange:function(b,d,f){if(2===b.length){if(i||j){var g=a((b[1].getTime()-b[0].getTime())/86400000),k=0;g<i?k=i-g:g>j&&(k=j-g),k&&(b[1].setDate(b[1].getDate()+k),f.setDate(b),f.open())}var l=b.map(function(a){return c.formatDate(a,e.dateFormat)});h.eq(0).val(l[0]),h.eq(1).val(l[1])}else h.eq(0).val(""),h.eq(1).val("")}})}b.extend(e,{time_24hr:-1===e.altFormat.indexOf("a")&&-1===e.altFormat.indexOf("A"),parseDate:function(a){var b=c.parseDate(a,e.dateFormat);return"U"===e.dateFormat&&(b=new Date(b.toLocaleString("en-US",{timeZone:"UTC"}))),b},formatDate:function(a,b){var d=c.formatDate(a,b);return"U"===b&&(d=parseInt(d)-60*a.getTimezoneOffset()),d}}),d.flatpickr(e)}),hivepress.getComponent("time").each(function(){var d=b(this),e={allowInput:!0,altInput:!0,noCalendar:!0,enableTime:!0,dateFormat:"U",altFormat:"g:i A",defaultHour:0,disableMobile:!0,parseDate:function(b){var c=new Date;return c.setHours(a(b/3600)),c.setMinutes(a(b%3600/60)),c.setSeconds(b%60),c},formatDate:function(a,b){return"U"===b?3600*a.getHours()+60*a.getMinutes()+a.getSeconds():c.formatDate(a,b)},onOpen:function(a,c,d){b(d.altInput).prop("readonly",!0),b(d.element).find("[data-clear]").show()},onClose:function(a,c,d){b(d.altInput).prop("readonly",!1),b(d.altInput).blur(),b(d.element).find("[data-clear]").hide(),b(d.element).data("reset")&&(d.clear(),b(d.element).data("reset",!1))}};d.is("div")&&(e.wrap=!0,e.altInputClass="",d.find("[data-clear]").on("click",function(){d.data("reset",!0)})),d.data("display-format")&&(e.altFormat=d.data("display-format")),-1===e.altFormat.indexOf("a")&&-1===e.altFormat.indexOf("A")&&(e.time_24hr=!0),d.flatpickr(e)}),hivepress.getComponent("file-upload").each(function(){var a=b(this),c=a.parents("[data-model]:first"),d=a.closest("form").find(":submit"),e=a.closest("label"),f=e.find("button").first(),g=e.parent().find(hivepress.getSelector("messages")).first(),h=e.parent().children("div").first();a.fileupload({url:a.data("url"),dataType:"json",paramName:"file",formData:{parent_model:c.data("model"),parent_field:a.data("name"),parent:c.data("id"),render:!0,_wpnonce:hivepressCoreData.apiNonce},start:function(){a.prop("disabled",!0),f.prop("disabled",!0),f.attr("data-state","loading"),d.length&&(d.prop("disabled",!0),d.attr("data-state","loading")),g.hide().html("")},stop:function(){a.prop("disabled",!1),f.prop("disabled",!1),f.attr("data-state",""),d.length&&(d.prop("disabled",!1),d.attr("data-state",""))},always:function(c,d){var e=d.jqXHR.responseJSON;e.hasOwnProperty("data")?a.prop("multiple")?h.append(e.data.html):h.html(e.data.html):e.hasOwnProperty("error")&&(e.error.hasOwnProperty("errors")?b.each(e.error.errors,function(a,b){g.append("<div>"+b.message+"</div>")}):e.error.hasOwnProperty("message")&&g.html("<div>"+e.error.message+"</div>"),!g.is(":empty")&&g.show())}})}),b(document).on("click",hivepress.getSelector("file-delete"),function(a){var c=b(this).parent();b.ajax({url:b(this).data("url"),method:"DELETE",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}}),c.remove(),a.preventDefault()}),hivepress.getComponent("sortable").each(function(){var a=b(this);a.sortable({stop:function(){1<a.children().length&&a.children().each(function(a){b.ajax({url:b(this).data("url"),method:"POST",data:{sort_order:a},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}})})}})}),hivepress.getComponent("repeater").each(function(){var a=b(this),c=a.find("tbody"),d=a.find("tr:first");c.sortable({handle:"[data-sort]"}),d.length&&a.find("[data-add]").on("click",function(){a.find("select").select2("destroy");var e=d.clone(),f=Math.random().toString(36).slice(2);f&&(e.find(":input").each(function(){var a=b(this),c=a.attr("name"),d=c.match(/\[([^\]]+)\]/);if(d&&a.attr("name",c.replace(d[1],f)),"checkbox"===a.attr("type")){var e="a"+Math.random().toString(36).slice(2);a.attr("id",e),a.closest("label").attr("for",e)}else a.val("")}),e.appendTo(c)),a.find("select").select2({width:"100%",minimumResultsForSearch:-1})}),a.on("click","[data-remove]",function(){1<a.find("tr").length&&b(this).closest("tr").remove()})}),hivepress.getComponent("chart").each(function(){var a=b(this),c=new Chart(a,{type:"line",options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{tooltipFormat:"MMM D, YYYY",unit:"week",displayFormats:{week:"MMM D, YYYY"}}}]}},data:{labels:a.data("labels"),datasets:a.data("datasets")}})}),hivepress.getComponent("form").each(function(){var c=b(this),d=c.find(".g-recaptcha"),e=b(".g-recaptcha").index(d.get(0)),f=c.find(":submit");if(!0===c.data("autosubmit")&&c.on("change",function(){c.submit()}),c.on("submit",function(){f.prop("disabled",!0),f.attr("data-state","loading")}),c.data("action")){var g=c.find(hivepress.getSelector("messages")).first(),h=g.attr("class").split(" ")[0];c.on("submit",function(a){g.hide().html("").removeClass(h+"--success "+h+"--error"),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),b.ajax({url:c.data("action"),method:"POST",data:new FormData(c.get(0)),contentType:!1,processData:!1,beforeSend:function(a){var d=c.data("method")?c.data("method"):c.attr("method");"POST"!==d&&a.setRequestHeader("X-HTTP-Method-Override",d),(b("body").hasClass("logged-in")||b("body").hasClass("wp-admin"))&&a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)},complete:function(i){var j=i.responseJSON,k=c.data("redirect");f.prop("disabled",!1),f.attr("data-state",""),"undefined"!=typeof grecaptcha&&d.length&&grecaptcha.reset(e);var l=i.getResponseHeader("Content-Disposition");if(l&&-1!==l.indexOf("attachment")&&-1!==l.indexOf(".csv")){var m=i.responseText.slice(1,-1).replaceAll("\\","").split("|").join("\r\n"),n=new Blob([m],{type:"text/csv;encoding:utf-8"}),o="",p=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(l);if(null!=p&&p[1]&&(o=p[1].replace(/['"]/g,"")),"undefined"!=typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,o);else{var q=window.URL||window.webkitURL,r=q.createObjectURL(n);if(o){var s=document.createElement("a");"undefined"==typeof s.download?window.location.href=r:(s.href=r,s.download=o,document.body.appendChild(s),s.click())}else window.location.href=r;setTimeout(function(){q.revokeObjectURL(r)},100)}}null==j||j.hasOwnProperty("data")?(c.data("message")&&307!==i.status&&g.addClass(h+"--success").html("<div>"+c.data("message")+"</div>").show(),k||307===i.status?"string"==typeof k?window.location.replace(k):window.location.reload(!0):(c.data("reset")||!c.is("[data-id]"))&&(c.trigger("reset"),c.find(hivepress.getSelector("file-upload")).each(function(){var a=b(this),c=a.closest("label"),d=c.parent().children("div").first();d.html("")}))):j.hasOwnProperty("error")&&(j.error.hasOwnProperty("errors")?b.each(j.error.errors,function(a,b){g.append("<div>"+b.message+"</div>")}):j.error.hasOwnProperty("message")&&g.html("<div>"+j.error.message+"</div>"),!g.is(":empty")&&g.addClass(h+"--error").show()),g.is(":visible")&&c.offset().top<b(window).scrollTop()&&b("html, body").animate({scrollTop:c.offset().top},500)}}),a.preventDefault()})}})})})(jQuery);